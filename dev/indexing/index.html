<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Arrays: more advanced indexing · JuliaImages</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="JuliaImages logo"/></a><h1>JuliaImages</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../install/">Getting started: Installation and testing your install</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../quickstart/">Quickstart</a></li><li><a class="toctext" href="../arrays_colors/">Arrays, Numbers, and Colors</a></li><li><a class="toctext" href="../conversions_views/">Conversions vs. views</a></li><li class="current"><a class="toctext" href>Arrays: more advanced indexing</a><ul class="internal"><li><a class="toctext" href="#Keeping-track-of-location-with-unconventional-indices-1">Keeping track of location with unconventional indices</a></li><li><a class="toctext" href="#Keeping-track-of-orientation-with-named-axes-1">Keeping track of orientation with named axes</a></li></ul></li><li><a class="toctext" href="../imageaxes/">ImageAxes.jl</a></li><li><a class="toctext" href="../imagefiltering/">ImageFiltering.jl</a></li><li><a class="toctext" href="../imagemetadata/">ImageMetadata.jl</a></li><li><a class="toctext" href="../imagesegmentation/">ImageSegmentation.jl</a></li><li><a class="toctext" href="../imagefeatures/">ImageFeatures.jl</a></li><li><a class="toctext" href="../troubleshooting/">Installation troubleshooting</a></li></ul></li><li><span class="toctext">Demos</span><ul><li><a class="toctext" href="../demos/">Demonstrations</a></li><li><a class="toctext" href="../demos/color_separations_svd/">Color separations and the SVD</a></li><li><a class="toctext" href="../demos/rgb_hsv_thresholding/">RGB to HSV and thresholding</a></li></ul></li><li><a class="toctext" href="../function_reference/">Summary and function reference</a></li><li><a class="toctext" href="../api_comparison/">Comparison with other image processing frameworks</a></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Arrays: more advanced indexing</a></li></ul><a class="edit-page" href="https://github.com/JuliaImages/juliaimages.github.io/blob/source/docs/src/indexing.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Arrays: more advanced indexing</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Arrays:-more-advanced-indexing-1" href="#Arrays:-more-advanced-indexing-1">Arrays: more advanced indexing</a></h1><p>In addition to the handling of numbers and colors, one of the main ways that JuliaImages leverages Julia is through a number of more sophisticated indexing operations. These are perhaps best illustrated with examples.</p><h2><a class="nav-anchor" id="Keeping-track-of-location-with-unconventional-indices-1" href="#Keeping-track-of-location-with-unconventional-indices-1">Keeping track of location with unconventional indices</a></h2><p>Consider the following pair of images:</p><table><tr><th style="text-align: center">imgref</th><th style="text-align: center">img</th></tr><tr><td style="text-align: center"><img src="../assets/indexing/cm.png" alt="cameraman"/></td><td style="text-align: center"><img src="../assets/indexing/cmrot.png" alt="cameraman"/></td></tr></table><p>You might guess that the one on the right is a rotated version of the one on the left. But, what is the angle? Is there also a translation?</p><p>A &quot;low tech&quot; way to test this is to rotate and shift the image on the right until it seems aligned with the one on the left. We could overlay the two images (<a href="../conversions_views/#Using-colorview-to-make-color-overlays-1">Using colorview to make color overlays</a>) to see how well we&#39;re doing.</p><pre><code class="language-julia-repl">julia&gt; using Images, CoordinateTransformations

julia&gt; tfm = recenter(RotMatrix(pi/8), center(img))
AffineMap([0.92388 -0.382683; 0.382683 0.92388], [88.7786, -59.3199])

julia&gt; imgrot = warp(img, tfm);

julia&gt; summary(img)
&quot;386×386 Array{Gray{N0f8},2} with eltype Gray{Normed{UInt8,8}}&quot;

julia&gt; summary(imgrot)
&quot;OffsetArray(::Array{Gray{N0f8},2}, -59:446, -59:446) with eltype Gray{Normed{UInt8,8}} with indices -59:446×-59:446&quot;</code></pre><p>While <code>img</code> has axes that start with the conventional 1, the summary of <code>imgrot</code> reports that it has axes <code>(-59:446, -59:446)</code>. This means that the first element of <code>imgrot</code> is indexed with <code>imgrot[-59,-59]</code> and the last element with <code>imgrot[446,446]</code>.</p><p>What is the meaning of these indices that extend beyond those of the original array in both directions? Displaying the rotated image–-especially when overlaid on the original–-reveals why:</p><pre><code class="language-julia">julia&gt; imgov = colorview(RGB, paddedviews(0, img, imgrot, zeroarray)...)</code></pre><p><img src="../assets/indexing/rot_overlay.png" alt="rot_overlay"/></p><p>The padding on all sides of the array leaves space for the fact that the rotated image (green) contains some pixels out of the region covered by the original image (red).  The fact that Julia allows these indices to be <em>negative</em> means that we have no trouble adding appropriate &quot;padding&quot; to the original image: we just copy the original over to the padded array, using its original indices.</p><p>We can test whether <code>imgrot</code> aligns well with the original unrotated image <code>imgref</code> at the top of this page:</p><pre><code class="language-julia">julia&gt; imgov_ref = colorview(RGB, paddedviews(0, imgref, imgrot, zeroarray)...)</code></pre><p><img src="../assets/indexing/ref_overlay.png" alt="ref_overlay"/></p><p>The fact that the overlapping portion looks yellow–-the combination of red and green–-indicates that we have perfect alignment.</p><p>You can learn more about Julia&#39;s support for arbitrary indices in <a href="https://julialang.org/blog/2017/04/offset-arrays">this blog post</a>.</p><h2><a class="nav-anchor" id="Keeping-track-of-orientation-with-named-axes-1" href="#Keeping-track-of-orientation-with-named-axes-1">Keeping track of orientation with named axes</a></h2><p>Suppose you are presented with a 3-dimensional grayscale image. Is this a movie (2d over time), or a 3d image (x, y, and z)? In such situations, one of the best ways to keep yourself oriented is by naming the axes. The TestImages package contains an example of a file that illustrates this:</p><pre><code class="language-julia-repl">julia&gt; using Images, TestImages

julia&gt; img = testimage(&quot;mri&quot;);

julia&gt; println(summary(img))
3-dimensional AxisArray{Gray{N0f8},3,...} with axes:
    :P, 0:1:225
    :R, 0:1:185
    :S, 0:5:130
And data, a 226×186×27 Array{Gray{N0f8},3} with eltype Gray{Normed{UInt8,8}}</code></pre><p>TestImages uses the <a href="https://github.com/JuliaArrays/AxisArrays.jl">AxisArrays package</a> to name the axes of this particular image in terms of the <a href="http://www.grahamwideman.com/gw/brain/orientation/orientterms.htm">RAS coordinate system</a> (Right, Anterior, Superior) as commonly used in magnetic resonance imaging. See the documentation for that package to learn more about how you can create your own <code>AxisArray</code> objects.</p><p>We can use this coordinate system to help with visualization. Let&#39;s look at a &quot;horizontal slice,&quot; one perpendicular to the superior-inferior axis (i.e., a slice with constant <code>S</code> value):</p><p><img src="../assets/indexing/mri_s_slice.png" alt="Sslice"/></p><p>From the summary you can see that the slice has just the <code>:A</code> and <code>:R</code> axes remaining.</p><p>We could slice along the <code>R</code> and <code>A</code> axes too, although for this image (which is sampled very anisotropically) they are not as informative.</p><p>The <a href="https://github.com/JuliaImages/ImageAxes.jl">ImageAxes</a> and <a href="https://github.com/JuliaImages/ImageMetadata.jl">ImageMetadata</a> packages add additional functionality to AxisArrays that may be useful when you need to encode more information about your image.</p><footer><hr/><a class="previous" href="../conversions_views/"><span class="direction">Previous</span><span class="title">Conversions vs. views</span></a><a class="next" href="../imageaxes/"><span class="direction">Next</span><span class="title">ImageAxes.jl</span></a></footer></article></body></html>
